using LibraryDifferentialEquations25Feb2024;
using LibraryRelativisticOscillator3mar2024;

namespace ConsoleRelativisticOscillator1mar2024
{
    class Program
    {
        static void Main(string[] args)
        {
            Console.WriteLine("The special relativistic generalization of the Harmonic Oscillator.");

            var solver = new DifferentialEquationsSolverRK5_1mar2024<double>(new DifferentialEquationsRelativisticOscillator3mar2024<double>());

            double interval = 5.0 * 2.0 * Math.PI; // 5 oscillations    
            ulong number_of_steps = 200;

            var stopwatch = System.Diagnostics.Stopwatch.StartNew();

            var ic = new ConditionInitial26feb2024<double>(0,
                                                       0.0,
                                                       0.9);
            //ic.X = 0;

            solver.Solve(sophisticated: true, initialCondition: ic, number_of_steps: number_of_steps, delta_x: out double delta_x, solutions: out NumericalSolutions26feb2024<double> solutions, number_of_solutions: 200, interval: interval, x_end: interval);

            string string_file_name = "rel_osc_RK5_" + DateTime.Now.ToString("ddMMMyyyy") + ".txt";

            FileStream aFileStream2 = new FileStream(string_file_name, FileMode.CreateNew);
            StreamWriter streamWriter1 = new StreamWriter(aFileStream2);

            for (int i = 0; i < solutions.Length; i++)
            {
                NumericalSolution26feb2024<double> solution = solutions[i];

                string string_time = solution.X.ToString("G15", System.Globalization.CultureInfo.InvariantCulture);
                streamWriter1.Write(string_time + "\t");

                string string_displacement = solution.Y[0].ToString("G15", System.Globalization.CultureInfo.InvariantCulture);
                streamWriter1.WriteLine(string_displacement);
            }

            streamWriter1.Close();

            stopwatch.Stop();
            double cpu_duration = stopwatch.Elapsed.TotalSeconds;
            Console.WriteLine($"De computer tijd nodig voor deze berekening is {cpu_duration} seconden.");
            // De computer tijd nodig voor deze berekening is 0,0188999 seconden.

            Console.WriteLine("Look in the text file for the results.");

            /*
0.15707963267949	0.141323336610809
0.314159265358979	0.282352180969868
0.471238898038469	0.422768792315905
0.628318530717959	0.562205118616527
0.785398163397448	0.700207108719995
0.942477796076938	0.836183258680255
1.09955742875643	0.969325830000733
1.25663706143592	1.09848539982948
1.41371669411541	1.22196697594639
1.5707963267949	1.33720105212354
1.72787595947439	1.4402474321095
1.88495559215388	1.52520685774129
2.04203522483337	1.5840842373227
2.19911485751286	1.60849453137964
2.35619449019234	1.59396422520202
2.51327412287183	1.5432382981011
2.67035375555132	1.46417129569574
2.82743338823081	1.36513450759748
2.9845130209103	1.25259747588979
3.14159265358979	1.13095177084157
3.29867228626928	1.00306598274457
3.45575191894877	0.870822919052781
3.61283155162826	0.735489080972088
3.76991118430775	0.597945838209091
3.92699081698724	0.458831459357652
4.08407044966673	0.318629667192319
4.24115008234622	0.177726791829617
4.39822971502571	0.0364507081080563
4.5553093477052	-0.10490040389041
4.71238898038469	-0.24603421290546
4.86946861306418	-0.386641336518236
5.02654824574367	-0.526369662885691
5.18362787842316	-0.664791447767264
5.34070751110265	-0.801356807917876
5.49778714378214	-0.935323450613113
5.65486677646163	-1.06564571074506
5.81194640914112	-1.19079479146202
5.96902604182061	-1.30846708710897
6.1261056745001	-1.41513232228464
6.28318530717959	-1.50544491697652
6.44026493985908	-1.57189176167736
6.59734457253857	-1.60586296611913
6.75442420521806	-1.60140962511234
6.91150383789754	-1.55938542036675
7.06858347057703	-1.48677908751338
7.22566310325652	-1.39218143275377
7.38274273593601	-1.2826299330603
7.5398223686155	-1.16300789038245
7.69690200129499	-1.03651913766075
7.85398163397448	-0.905258600147279
8.01106126665397	-0.77062494736539
8.16814089933346	-0.633582435365484
8.32522053201295	-0.494821871894449
8.48230016469244	-0.354860384311678
8.63937979737193	-0.21410512894977
8.79645943005142	-0.0728960003059294
8.95353906273091	0.068463568236971
9.1106186954104	0.209681902533287
9.26769832808989	0.350456293509467
9.42477796076938	0.490448413702117
9.58185759344887	0.629253784256618
9.73893722612836	0.766359554980269
9.89601685880785	0.901081643053437
10.0530964914873	1.03246641454671
10.2101761241668	1.15913216175792
10.3672557568463	1.27901118239478
10.5243353895258	1.38894247495144
10.6814150222053	1.48410453389492
10.8384946548848	1.55752765727126
10.9955742875643	1.6006374351721
11.1526539202438	1.60632220232858
11.3097335529233	1.57349269624292
11.4668131856027	1.50793460488408
11.6238928182822	1.41824562182062
11.7809724509617	1.31200118843265
11.9380520836412	1.19461271115915
12.0951317163207	1.06965813833976
12.2522113490002	0.939471782573771
12.4092909816797	0.80560160509798
12.5663706143592	0.669105243459724
12.7234502470387	0.530732550162953
12.8805298797182	0.391038217104061
13.0376095123976	0.250453020636041
13.1946891450771	0.109330893433269
13.3517687777566	-0.0320178566580796
13.5088484104361	-0.173300715756745
13.6659280431156	-0.31422003456196
13.8230076757951	-0.454449268631843
13.9800873084746	-0.593604442058188
14.1371669411541	-0.73120563214783
14.2942465738336	-0.866620553514114
14.451326206513	-0.998977265936588
14.6084058391925	-1.12702428386062
14.765485471872	-1.24890290175649
14.9225651045515	-1.36178280071907
15.079644737231	-1.46132947395668
15.2367243699105	-1.54114281313086
15.39380400259	-1.59288976688581
15.5508836352695	-1.60863431293802
15.707963267949	-1.58541033612719
15.8650429006285	-1.52749321436126
16.0221225333079	-1.4432209890761
16.1792021659874	-1.3406407878333
16.3362817986669	-1.22572045906864
16.4933614313464	-1.10245287244715
16.6504410640259	-0.973442099404346
16.8075206967054	-0.840404784312641
16.9646003293849	-0.704503852009975
17.1216799620644	-0.566555542108652
17.2787595947439	-0.427156760993113
17.4358392274234	-0.286764982650742
17.5929188601028	-0.145750353882603
17.7499984927823	-0.00443175169207297
17.9070781254618	0.136895964690517
18.0641577581413	0.277938645922947
18.2212373908208	0.418379659381859
18.3783170235003	0.557853010910147
18.5353966561798	0.695908019164988
18.6924762888593	0.831958501421835
18.8495559215388	0.965205090307492
19.0066355542182	1.09451165137134
19.1637151868977	1.21820449425059
19.3207948195772	1.33374814064539
19.4778744522567	1.43725443546094
19.6349540849362	1.52289263819418
19.7920337176157	1.58272157807185
19.9491133502952	1.60831333717746
20.1061929829747	1.5950000648869
20.2632726156542	1.54530345207301
20.4203522483337	1.46699098874078
20.5774318810131	1.36847011029483
20.7345115136926	1.25627999249565
20.8915911463721	1.13486987045451
21.0486707790516	1.00714709478352
21.2057504117311	0.875018902143396
21.3628300444106	0.739767015963616
21.5199096770901	0.602282364482866
21.6769893097696	0.463209281363766
21.8340689424491	0.323035343214108
21.9911485751286	0.182149271672885
22.148228207808	0.0408803001511643
22.3053078404875	-0.10047283653425
22.462387473167	-0.241617966178008
22.6194671058465	-0.382246604881387
22.776546738526	-0.522008426801046
22.9336263712055	-0.660478670342379
23.090706003885	-0.797112185937954
23.2477856365645	-0.931174121681186
23.404865269244	-1.06163059041628
23.5619449019234	-1.18697163936418
23.7190245346029	-1.30492386407316
23.8761041672824	-1.41200399561504
24.0331837999619	-1.50293190725784
24.1902634326414	-1.57025803433522
24.3473430653209	-1.60536395750318
24.5044226980004	-1.60214198213812
24.6615023306799	-1.56121011747263
24.8185819633594	-1.48942862802785
24.9756615960389	-1.39540161151721
25.1327412287183	-1.28623414347907
25.2898208613978	-1.16687186811377
25.4469004940773	-1.04056195385106
25.6039801267568	-0.909426897671374
25.7610597594363	-0.774882553069664
25.9181393921158	-0.637903936799468
26.0752190247953	-0.499188668807413
26.2322986574748	-0.359258210274604
26.3893782901543	-0.218522433747438
26.5464579228338	-0.0773228294481537
26.7035375555132	0.0640364210898123
26.8606171881927	0.205263620820052
27.0176968208722	0.346056759388343
27.1747764535517	0.48607904380796
27.3318560862312	0.624928627087916
27.4889357189107	0.762096867817667
27.6460153515902	0.896906300548916
27.8030949842697	1.02841373863267
27.9601746169492	1.15525414787247
28.1172542496286	1.27538658485848
28.2743338823081	1.38569222076732
28.4314135149876	1.4814107823819
28.5884931476671	1.5556409651356
28.7455727803466	1.59982782388475
28.9026524130261	1.60674136886384
29.0597320457056	1.5750585390231
29.2168116783851	1.5103970024957
29.3738913110646	1.42133813166741
29.5309709437441	1.31551900637863
29.6880505764235	1.19841731474016
29.845130209103	1.07365919599979
30.0022098417825	0.943610044561898
30.159289474462	0.809837228033873
30.3163691071415	0.673410507484922
30.473448739821	0.535087389770877
30.6305283725005	0.395427436162658
30.78760800518	0.254864495988343
30.9446876378595	0.113754352372804
31.101767270539	-0.0275917374617271
31.2588469032184	-0.168881054691819
31.4159265358979	-0.309816456537848
*/
            Console.WriteLine("Press Enter.");
            Console.ReadLine();
        }
    }
}



